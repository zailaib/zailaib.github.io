---
import { ClientRouter } from 'astro:transitions';
import Sidebar from '../components/Sidebar.astro';

interface SidebarPost {
  title: string;
  slug: string;
  date: string;
  tags: string | string[];
}

interface Props {
  title?: string;
  showSidebar?: boolean;
  sidebarData?: Record<string, SidebarPost[]>;
}

const { 
  title = 'Astro Basics', 
  showSidebar = true,
  sidebarData 
} = Astro.props;

// 在构建时导入预生成的侧边栏数据
const defaultSidebarData = await import('../generated/sidebar.json');
const postsByCategory = sidebarData || (defaultSidebarData as any).default as Record<string, SidebarPost[]>;
---

<!doctype html>
<html lang="zh">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="generator" content={Astro.generator} />
		<title>{title}</title>
	</head>
	<body>
    <div class="app-container">
      {showSidebar && <Sidebar postsByCategory={postsByCategory} />}
      <main class="content">
        <slot />
      </main>
    </div>
    <ClientRouter />
	</body>
</html>

<style>
	html,
	body {
		margin: 0;
		width: 100%;
		height: 100%;
	}
  
  .app-container {
    display: flex;
    gap: 2rem;
    padding: 1rem;
    max-width: 1200px;
    margin: 0 auto;
  }
  
  .content {
    flex: 1;
  }
</style>
