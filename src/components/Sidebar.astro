---
import ArticleList from './ArticleList.astro';

interface SidebarPost {
  title: string;
  slug: string;
  date: string;
  tags: string | string[];
  category?: string;
}

interface Props {
  postsByCategory: Record<string, SidebarPost[]>;
}

const { postsByCategory } = Astro.props;

// 将所有文章展平并添加分类信息
const allArticles = Object.entries(postsByCategory).flatMap(([category, posts]) =>
  posts.map(post => ({ ...post, category }))
);
---

<aside class="sidebar">
  <ArticleList 
    articles={allArticles} 
    mode="sidebar" 
    groupByCategory={true}
    showTags={true}
    showDate={true}
  />
</aside>

<style>
  .sidebar {
    width: 300px;
    position: sticky;
    top: 1rem;
  }
</style>
